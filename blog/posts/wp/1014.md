<!--
author: vaster
date: 2015-09-10 15:19:37
title: 【AWS】整盘格式化与分区格式化
tags: EBS,EC2
category: AWS,EC2
status: publish
summary: AWS上的资源是按时按量收费的，所以，我们在项目前期评估资源通常是按最小化使用进行资源分配，后期量大了再将资源扩大。例如：一个20GB的磁盘，用着用着就发现不够用了，于是决定采用以下办法将磁盘扩容：（1）将磁盘做成快照（2）基于快照创建一个大点的磁盘（3）在实例上换成新的磁盘这过
-->

AWS上的资源是按时按量收费的，所以，我们在项目前期评估资源通常是按最小化使用进行资源分配，后期量大了再将资源扩大。

例如：一个<span lang="EN-US">20GB</span>的磁盘，用着用着就发现不够用了，于是决定采用以下办法将磁盘扩容：

（<span lang="EN-US">1</span>）将磁盘做成快照（<span lang="EN-US">2</span>）基于快照创建一个大点的磁盘（<span lang="EN-US">3</span>）在实例上换成新的磁盘

这过程看着没啥问题，可问题在于，你的文件系统上有分区吗，你的文件系统能扩展吗，你创建的分区能扩展吗？ 尤其那些喜欢在单盘上建单分区的同学，整个磁盘是变大了，可是你创建的分区不会跟着变大，这时你需要手动修改分区表这种危险操作将例如<span lang="EN-US">/dev/xvdf1</span>这样的分区变大，冒着数据丢失的风险。

最好和最简单的办法就是：根分区已经弄好了，单独创建的一块<span lang="EN-US">EBS</span>磁盘用于存储数据，不需要再给数据盘做分区了，直接整盘格式化使用就好（<span lang="EN-US">mkfs.ext4 /dev/xvdf</span> ）

在云上，一块磁盘上建一个分区，然后挂载分区使用，这样会造成文件系统扩容难度及风险增大，尤其是通过快照扩容磁盘的时候。

在云上，一块磁盘不创建分区，直接创建文件系统使用，这样基于快照的扩大磁盘的时候，因为没分区，整个文件系统就在磁盘上，磁盘变大文件系统跟着变大，即使没跟着变大，使用<span lang="EN-US">resize2fs /dev/xvdf</span>也能扩大，<span lang="EN-US">windows</span>下是需要手动修改。